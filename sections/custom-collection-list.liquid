{%- liquid
	assign section_heading = section.settings.heading
	assign marker_style = section.settings.marker_style
	assign section_description = section.settings.description
	assign heading_size = section.settings.heading_size
	assign columns_desktop = section.settings.columns_desktop
	assign columns_mobile = section.settings.columns_mobile
	assign show_progress_bar = section.settings.show_progress_bar
	assign mobile_swipe = section.settings.mobile_swipe
	assign collections = section.settings.collection_list
	assign style = section.settings.style
	assign text_alignment = section.settings.text_alignment
	assign heading_position = section.settings.heading_position
	assign collection_layout = section.settings.collection_layout

	assign marker_color = section.settings.marker_color
	assign text_color = section.settings.text_color
	assign overlay_color = section.settings.overlay_color
	assign overlay_opacity = section.settings.overlay_opacity

	assign disable_top_spacing = section.settings.disable_top_spacing
	assign disable_bottom_spacing = section.settings.disable_bottom_spacing
	assign is_carousel = false

	assign tag = 'div'
	if collection_layout == 'carousel'
	assign tag = 'slide-show'
		assign is_carousel = true
		assign carousel_class = 'carousel'
	endif
-%}

{%- liquid

	assign mobile_columns_class = 'small-12'
	if is_carousel
		if columns_mobile == '2'
			assign mobile_columns_class = 'small-5'
		endif
		assign columns_class = 'medium-6 large-4'
		case columns_desktop
			when 2
				assign columns_class = 'medium-6'
			when 3
				assign columns_class = 'medium-4'
			when 4
				assign columns_class = 'medium-6 large-3'
			when 5
				assign columns_class = 'medium-1/5 large-1/5'
			when 6
				assign columns_class = 'medium-3 large-2'
		endcase
		assign columns_class = columns_class | append: ' carousel__slide columns'
	endif

	assign dots = true
	if section.blocks.size < 2
		assign dots = false
	endif
-%}
{{ 'room-grid.css' | asset_url | stylesheet_tag }}

<div class="row">
	<div class="small-12 columns">
		<div class="list-collections section-spacing{% if disable_top_spacing %} section-spacing--disable-top{% endif %}{% if disable_bottom_spacing %} section-spacing--disable-bottom{% endif %}" style="--overlay-color-rgb: {{ overlay_color.rgb | replace: ' ' , ',' }}; --overlay-opacity: {{ overlay_opacity | divided_by: 100.0 }}; --var-collection-list-columns:{{ columns_desktop }}; --collection-text-color: {{ text_color }}">
			{%- if section_heading != blank or section_description != blank -%}
<div class="section-header">
	<div class="section-header--content">
		{%- if section_heading -%}
                    <h3 class="section-header--title">
                        {% render 'animated-marker-heading', heading: section_heading, style: marker_style, color: marker_color %}
                    </h3>
                {%- endif -%}
                {%- if section_description != blank -%}
                    <div class="section-header--description rte">
                        {{ section_description }}
                    </div>
                {%- endif -%}
            </div>
            {%- if section_heading_button -%}
            <div class="section-header--button">
                {% assign text_button_title = 'sections.featured_collection.shop_collection' | t: collection: section_heading_button.title %}
                {% render 'text-button', url: section_heading_button.url, title: text_button_title %}
            </div>
            {%- elsif section_heading_button_blog -%}
            <div class="section-header--button">
                {% assign text_button_title = 'sections.featured_blog.view_all' | t %}
                {% render 'text-button', url: section_heading_button_blog.url, title: text_button_title %}
            </div>
            {%- endif -%}
            {%- if blocks -%}
            <scroll-shadow>
                <collection-tabs class="collection-tabs__list" data-target="product-grid-{{ section_id }}">
                    {%- for block in blocks -%}
                        {%- if block.settings.collection != blank -%}
                            <button type="button" data-collection="{{ block.settings.collection.handle }}" class="collection-tabs__list-link{% if forloop.first == true %} active{% endif %}" {{ block.shopify_attributes }}>{{ block.settings.collection.title }}</button>
                        {%- else -%}
                            <button type="button" data-collection="collection-{{ block.id }}" class="collection-tabs__list-link{% if forloop.first == true %} active{% endif %}" {{ block.shopify_attributes }}>Collection {{ forloop.index }}</button>
                        {%- endif -%}
                    {%- endfor -%}
                </collection-tabs>
            </scroll-shadow>
            {%- endif -%}
        </div>
        {%- endif -%}
			<{{ tag }} class="collection-grid collection-grid__{{ collection_layout }} {{ carousel_class }}{% if collection_layout == 'grid' and mobile_swipe %} swipe-on-mobile{% endif %} mobile-columns--{{ columns_mobile | default: 1 }}" data-dots="{{ dots }}">
                {% for block in section.blocks %}
				<div class="{{ mobile_columns_class }} {{ columns_class }}">
					{% assign video = block.settings.video %}	
					{% assign video_autoplay = block.settings.video_autoplay %}	
					{%- if video != blank -%}
						{% assign loop_param = '&loop=1&playlist=' | append: video.id %} 
					<div class="room-card" aria-label="{{ block.settings.card_title }}">
						<div class="{% if video != blank %}video-card{% endif %} room-image">
						{% if video.type == 'youtube' %}
							<iframe
							src="https://www.youtube.com/embed/{{ video.id }}?enablejsapi=1{{ loop_param }}{% if video_autoplay %}&autoplay=1&mute=1{% endif %}"
							frameborder="0"
							class="lazyload"
							allow="autoplay; encrypted-media"
							allowfullscreen
							title="{{ section.settings.heading | escape }}"
							tabindex="-1">
							</iframe>

						{% elsif video.type == 'vimeo' %}
							<iframe
							src="https://player.vimeo.com/video/{{ video.id }}?loop=1{% if video_autoplay %}&autoplay=1&muted=1&background=1{% endif %}"
							frameborder="0"
							class="lazyload"
							allow="autoplay; fullscreen; picture-in-picture"
							allowfullscreen
							title="{{ section.settings.heading | escape }}"
							tabindex="-1">
							</iframe>
						{% endif %}
	
						</div>
						<div class="room-overlay"></div>
						{% if block.settings.card_title %} <div class="room-title body-small text-center">{{ block.settings.card_title }}</div> {% endif %}
					</div>	
					{% else %}
					<a class="room-card" href="{{ block.settings.card_url }}" aria-label="{{ block.settings.card_title }} " role="link">
						<div class="room-image">
						{%- if block.settings.card_image != blank -%}
							{%- liquid
							assign image = block.settings.card_image
							assign master_width = image.src.width | append: 'x' | append: image.src.height
							render 'responsive-image', image: image, sizes: master_width, retina: true, alt: block.settings.card_title
							-%}
						{%- else -%}
							<div class="thb-placeholder">
							{{ 'image' | placeholder_svg_tag: 'placeholder_svg_tag' }}
							</div>
						{%- endif -%}
						</div>
						<div class="room-overlay"></div>
						{% if block.settings.card_title %} <div class="room-title body-small text-center">{{ block.settings.card_title }}</div> {% endif %}
					</a>
					{% endif %}
				</div>
                {% endfor %}
					<div class="flickity-nav flickity-prev" tabindex="0">{% render 'svg-icons' with 'carousel-prev' %}</div>
					<div class="flickity-nav flickity-next" tabindex="0">{% render 'svg-icons' with 'carousel-next' %}</div>
			</{{ tag }}>
		</div>
	</div>
</div>
{{- 'list-collections.css' | asset_url | stylesheet_tag -}}
{% schema %}
  {
    "name": "Custom Collection list",
	  "class": "section-collection-list custom-collection-list",
    "settings": [
			{
				"type": "text",
				"id": "heading",
				"label": "Heading",
				"default": "Shop by Category",
				"info": "Wrap your text between | to add animated markers. For example: Animated |marker| will underline marker text."
			},
			{
				"type": "select",
				"id": "marker_style",
				"options": [
					{
						"value": "style1",
						"label": "Basic"
					},
					{
						"value": "style2",
						"label": "Double"
					},
					{
						"value": "style3",
						"label": "Squiggle"
					},
					{
						"value": "style4",
						"label": "Zigzag"
					}
				],
				"default": "style1",
				"label": "Marker"
			},
			{
				"type": "richtext",
				"id": "description",
				"label": "Description",
				"default": "<p>Add a short description for your collections</p>"
			},
			{
				"type": "select",
				"id": "heading_size",
				"options": [
					{
						"value": "small",
						"label": "Small"
					},
					{
						"value": "medium",
						"label": "Medium"
					},
					{
						"value": "large",
						"label": "Large"
					}
				],
				"default": "small",
				"label": "Collection heading size"
			},
			{
			  "type": "collection_list",
			  "id": "collection_list",
			  "label": "Collections",
			  "limit": 18
			},
			{
	      "type": "select",
	      "id": "image_ratio",
	      "options": [
	        {
	          "value": "adapt",
	          "label": "Adapt to image"
	        },
	        {
	          "value": "portrait",
	          "label": "Portrait"
	        },
	        {
	          "value": "square",
	          "label": "Square"
	        }
	      ],
	      "default": "portrait",
	      "label": "Image ratio",
	      "info": "Add images by editing your collections. [Learn more](https://help.shopify.com/en/manual/products/collections)"
	    },
			{
				"type": "select",
				"id": "collection_layout",
				"options": [
					{
						"value": "grid",
						"label": "Grid"
					},
					{
						"value": "carousel",
						"label": "Carousel"
					}
				],
				"default": "grid",
				"label": "Layout"
			},
			{
				"type": "select",
				"id": "style",
				"options": [
					{
						"value": "style1",
						"label": "Underneath image"
					},
					{
						"value": "style2",
						"label": "Over image"
					}
				],
				"default": "style1",
				"label": "Style"
			},
			{
				"type": "select",
				"id": "text_alignment",
				"options": [
					{
						"value": "left",
						"label": "Left"
					},
					{
						"value": "center",
						"label": "Center"
					},
					{
						"value": "right",
						"label": "Right"
					}
				],
				"default": "center",
				"label": "Text alignment"
			},
			{
	      "type": "range",
	      "id": "columns_desktop",
	      "min": 2,
	      "max": 6,
	      "step": 1,
	      "default": 4,
	      "label": "Number of columns on desktop"
	    },
			{
				"type": "select",
				"id": "columns_mobile",
				"options": [
					{
						"value": "1",
						"label": "One column"
					},
					{
						"value": "2",
						"label": "Two Columns"
					}
				],
				"default": "1",
				"label": "Number of columns on mobile"
			},
			{
        "type": "header",
        "content": "Carousel"
      },
    {
        "type": "checkbox",
        "id": "show_progress_bar",
        "label": "Show progress bar",
        "default": true
    },
    {
        "type": "header",
        "content": "Grid"
      },
    {
        "type": "checkbox",
        "id": "mobile_swipe",
        "default": true,
        "label": "Enable swipe on mobile"
    },
    {
        "type": "header",
        "content": "Over image"
      },
        {
                "type": "select",
                "id": "heading_position",
                "label": "Heading position",
                "options": [
                    { "value": "top-left", "label": "Top left" },
                    { "value": "top-center", "label": "Top center" },
                    { "value": "top-right", "label": "Top right" },
                    { "value": "middle-left", "label": "Middle left" },
                    { "value": "middle-center", "label": "Middle center" },
                    { "value": "middle-right", "label": "Middle right" },
                    { "value": "bottom-left", "label": "Bottom left" },
                    { "value": "bottom-center", "label": "Bottom center" },
                    { "value": "bottom-right", "label": "Bottom right" }
                ],
                "default": "bottom-center"
        },
        {
        "type": "header",
        "content": "Colors"
      },
        {
            "type": "color",
            "id": "marker_color",
            "label": "Marker",
            "default": "#FD6262"
        },
        {
            "type": "color",
            "id": "text_color",
            "label": "Text",
            "default": "#2C2D2E"
        },
        {
            "type": "color",
            "id": "overlay_color",
            "label": "Overlay",
            "default": "transparent"
        },
        {
            "type": "range",
            "id": "overlay_opacity",
            "min": 0,
            "max": 100,
            "step": 1,
            "unit": "%",
            "label": "Overlay opacity",
            "default": 30
        },
        {
    "type": "header",
    "content": "Spacing"
      },
        {
            "type": "checkbox",
            "id": "disable_top_spacing",
            "default": false,
            "label": "Remove top spacing"
        },
        {
            "type": "checkbox",
            "id": "disable_bottom_spacing",
            "default": false,
            "label": "Remove bottom spacing"
        }
    ],
    "blocks": [
    {
      "type": "room",
      "name": "Room Card",
      "settings": [
		{
			"type": "video_url",
			"id": "video",
			"label": "Video URL",
					"accept": [
			"youtube",
			"vimeo"
			],
			"placeholder": "Use a YouTube or Vimeo URL",
			"default": "https:\/\/www.youtube.com\/watch?v=_9VUPq3SxOc"
      	},
		{
			"type": "checkbox",
			"id": "video_autoplay",
			"default": true,
			"label": "Autoplay",
			"info": "Video will be muted"
		},
        {
          "type": "image_picker",
          "id": "card_image",
          "label": "Image",
		  "info": "413*500 Size Image Add"
        },
        {
          "type": "text",
          "id": "card_title",
          "label": "Title"
        },
        {
          "type": "url",
          "id": "card_url",
          "label": "Link URL"
        }
      ]
    }
  ],
    "presets": [
      {
        "name": "Custom Collection list"
      }
    ],
		"enabled_on": {
			"templates": ["*"],
			"groups": [
				"header", "footer"
			]
		}
  }
{% endschema %}
