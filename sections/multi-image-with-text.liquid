{{- 'multi-image-with-text.css' | asset_url | stylesheet_tag -}}
{%- liquid	
	assign column_spacing = section.settings.column_spacing
	assign desktop_image_width = section.settings.desktop_image_width
	
	assign disable_top_spacing = section.settings.disable_top_spacing
	assign disable_bottom_spacing = section.settings.disable_bottom_spacing
	assign desktop_spacing_top = section.settings.desktop_spacing_top
	assign desktop_spacing_bottom = section.settings.desktop_spacing_bottom
	assign mobile_spacing_top = section.settings.mobile_spacing_top
	assign mobile_spacing_bottom = section.settings.mobile_spacing_bottom
-%}
{% style %}
	#shopify-section-{{ section.id }} {
		--section-spacing-mobile-top: {{ mobile_spacing_top | default: '15' | append: 'px' }};
		--section-spacing-mobile-bottom: {{ mobile_spacing_bottom | default: '15' | append: 'px' }};
		--section-spacing-desktop-top: {{ desktop_spacing_top | default: '30' | append: 'px' }};
		--section-spacing-desktop-bottom: {{ desktop_spacing_bottom | default: '30' | append: 'px' }};
	}
{% endstyle %}

<div class="section-spacing{% if disable_top_spacing %} section-spacing--disable-top{% endif %}{% if disable_bottom_spacing %} section-spacing--disable-bottom{% endif %}">
  <div class="row">
    <div class="small-12 columns">
    	<div class="multi-image-with-text-list">
				{%- for block in section.blocks -%}
					{%- liquid
						assign image = block.settings.image
						assign mobile_image = block.settings.mobile_image

						assign desktop_layout = block.settings.layout

						assign subheading = block.settings.subheading
						assign heading = block.settings.heading | newline_to_br
						assign text = block.settings.text
						
						assign marker_color = block.settings.marker_color
						assign marker_style = block.settings.marker_style
						
						assign color_bg = block.settings.color_bg
						assign color_heading = block.settings.color_heading
						assign color_text = block.settings.color_text
						assign color_links = block.settings.color_links

						assign ratio = 1
						if image != blank
							assign ratio = image.aspect_ratio
						endif
						if mobile_image != blank
							assign mobileRatio = mobile_image.aspect_ratio
						endif
					-%}
					{% style %}
						#multi-image-with-text-{{ block.id }} {
							--ratio-percent: {{ 1 | divided_by: ratio | times: 100 }}%;
						}
						{% if mobile_image != blank %}
							@media only screen and (max-width: 767px) {
								#multi-image-with-text-{{ block.id }} {
									--ratio-percent: {{ 1 | divided_by: mobileRatio | times: 100 }}%;
								}
							}
						{% endif %}
					{% endstyle %}
					<div id="multi-image-with-text-{{ block.id }}" class="multi-image-with-text column-spacing--{{ column_spacing }} grid--image-{{ desktop_image_width }} {{ desktop_layout }}" style="--color-bg:{{ color_bg }}; --color-heading: {{ color_heading }}; --color-text:{{ color_text }}; --color-text-rgb: {{ color_text.rgb | replace: ' ' , ',' }}; --color-accent: {{ color_links }}; --color-accent-rgb: {{ color_links.rgb | replace: ' ' , ',' }}; --bg-body: {{ color_bg }};" {{ block.shopify_attributes }}>
						<div class="multi-image-with-text--image multi-image-with-text--inner">
							<div class="multi-image-with-text--image-media aspect-ratio aspect-ratio--adapt">
								{%- if image != blank -%}
									{%- liquid
										assign small_height = image.src.height | times: '690' | divided_by: image.src.width
										assign mid_height = image.src.height | times: '1280' | divided_by: image.src.width
										assign master_width = image.src.width | append: 'x' | append: image.src.height
										assign width = '690x' | append: small_height | append: ',' | append: '1280x' | append: mid_height | append: ',' | append: master_width
										assign class = ''
										if mobile_image != blank
											assign class = ' multi-image-with-text--desktop'
										endif
										render 'responsive-image', image: image, sizes: width, class: class
									-%}
									{%- if mobile_image != blank -%}
										{%- liquid
											assign image = mobile_image
											assign small_height = image.src.height | times: '375' | divided_by: image.src.width
											assign mid_height = image.src.height | times: '690' | divided_by: image.src.width
											assign master_width = image.src.width | append: 'x' | append: image.src.height
											assign width = '375x' | append: small_height | append: ',' | append: '690x' | append: mid_height | append: ',' | append: master_width
											assign mobileClass = ' multi-image-with-text--mobile'
											render 'responsive-image', image: image, sizes: width, class: mobileClass
										-%}
									{%- endif -%}
								{%- else -%}
									{{ 'image' | placeholder_svg_tag: 'placeholder_svg_tag' }}
								{%- endif -%}
							</div>
						</div>
						<div class="multi-image-with-text--content multi-image-with-text--inner">
							<div class="multi-image-with-text--content--inner">
								{%- if subheading != blank -%}
									<p class="subheading">{{ subheading }}</p>
								{%- endif -%}
								{%- if heading != blank -%}
									<h3 class="{{ block.settings.heading_size }}">{% render 'animated-marker-heading', heading: heading, style: marker_style, color: marker_color %}</h3>
								{%- endif -%}
								{%- if text != blank -%}
									<div class="rte">{{ text }}</div>
								{%- endif -%}
								{%- if block.settings.button_text_1 != blank or block.settings.button_text_2 != blank or block.settings.button_text_3 != blank -%}
									<div class="multi-image-with-text--buttons">
										{%- if block.settings.button_text_1 != blank -%}
											<a class="button {{ block.settings.button_color_1 }}" href="{{ block.settings.button_link_1 }}" role="button" title="{{ block.settings.button_text_1 | escape }}">{{ block.settings.button_text_1 }}</a>
										{%- endif -%}
										{%- if block.settings.button_text_2 != blank -%}
											<a class="button {{ block.settings.button_color_2 }}" href="{{ block.settings.button_link_2 }}" role="button" title="{{ block.settings.button_text_2 | escape }}">{{ block.settings.button_text_2 }}</a>
										{%- endif -%}
										{%- if block.settings.button_text_3 != blank -%}
											<a class="button {{ block.settings.button_color_3 }}" href="{{ block.settings.button_link_3 }}" role="button" title="{{ block.settings.button_text_3 | escape }}">{{ block.settings.button_text_3 }}</a>
										{%- endif -%}
									</div>
								{%- endif -%}
							</div>
						</div>
					</div>
				{%- endfor -%}
    	</div>
    </div>
  </div>
</div>

{% schema %}
  {
    "name": "Multi image with text",
		"class": "section-multi-image-with-text",
    "settings": [
			{
				"type": "header",
				"content": "Layout"
			},
			{
				"type": "select",
				"id": "desktop_image_width",
				"options": [
					{
						"value": "small",
						"label": "Small"
					},
					{
						"value": "medium",
						"label": "Medium"
					},
					{
						"value": "large",
						"label": "Large"
					}
				],
				"default": "medium",
				"label": "Desktop image width",
				"info": "Image is automatically optimized for mobile."
			},
			{
	      "type": "select",
	      "id": "column_spacing",
	      "options": [
	        {
	          "value": "small",
	          "label": "Small"
	        },
					{
	          "value": "medium",
	          "label": "Medium"
	        },
	        {
	          "value": "large",
	          "label": "Large"
	        }
	      ],
	      "default": "medium",
	      "label": "Column spacing"
	    },
			{
				"type": "header",
				"content": "Spacing"
			},
			{
				"type": "checkbox",
				"id": "disable_top_spacing",
				"default": false,
				"label": "Remove top spacing"
			},
			{
				"type": "checkbox",
				"id": "disable_bottom_spacing",
				"default": false,
				"label": "Remove bottom spacing"
			},
			{
				"type": "header",
				"content": "Desktop spacing"
			},
			{
				"type": "range",
				"id": "desktop_spacing_top",
				"min": 0,
				"max": 200,
				"step": 5,
				"unit": "px",
				"label": "Desktop spacing top",
				"default": 100,
				"info": "Changes the section top spacing in desktop screens."
			},
			{
				"type": "range",
				"id": "desktop_spacing_bottom",
				"min": 0,
				"max": 200,
				"step": 5,
				"unit": "px",
				"label": "Desktop spacing bottom",
				"default": 100,
				"info": "Changes the section bottom spacing in desktop screens."
			},
			{
				"type": "header",
				"content": "Mobile spacing"
			},
			{
				"type": "range",
				"id": "mobile_spacing_top",
				"min": 0,
				"max": 200,
				"step": 5,
				"unit": "px",
				"label": "Mobile spacing top",
				"default": 50,
				"info": "Changes the section top spacing in mobile screens."
			},
			{
				"type": "range",
				"id": "mobile_spacing_bottom",
				"min": 0,
				"max": 200,
				"step": 5,
				"unit": "px",
				"label": "Mobile spacing bottom",
				"default": 50,
				"info": "Changes the section bottom spacing in mobile screens."
			}
    ],
    "blocks": [
      {
        "type": "imgae-with-text",
        "name": "Image with text",
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image",
            "info": "1340 x 1340 .jpg recommended."
          },
          {
            "type": "image_picker",
            "id": "mobile_image",
            "label": "Mobile image (optional)",
            "info": "650 x 650 .jpg recommended."
          },
          {
						"type": "text",
						"id": "subheading",
						"label": "Subheading",
						"default": "Add a tagline"
					},
          {
						"type": "text",
						"id": "heading",
						"label": "Heading",
						"default": "Image with text",
						"info": "Wrap your text between | to add animated markers. For example: Animated |marker| will underline marker text."
					},
					{
						"type": "select",
						"id": "marker_style",
						"options": [
							{
								"value": "style1",
								"label": "Basic"
							},
							{
								"value": "style2",
								"label": "Double"
							},
							{
								"value": "style3",
								"label": "Squiggle"
							},
							{
								"value": "style4",
								"label": "Zigzag"
							}
						],
						"default": "style1",
						"label": "Marker"
					},
					{
						"type": "select",
						"id": "heading_size",
						"label": "Size",
						"options": [
							{
								"value": "h1",
								"label": "Extra Large"
							},
							{
								"value": "h2",
								"label": "Large"
							},
							{
								"value": "h3",
								"label": "Medium"
							},
							{
								"value": "h4",
								"label": "Small"
							}
						],
						"default": "h3"
					},
          {
            "type": "richtext",
            "id": "text",
            "label": "Content",
            "default": "<p>Pair text with an image to focus on your chosen product, collection, or blog post. Add details on availability, style, or even provide a review.</p>"
          },
          {
						"type": "text",
						"id": "button_text_1",
						"label": "Button label 1",
						"default": "Shop Now",
						"info": "Leave the label blank to hide the button."
					},
					{
						"type": "url",
						"id": "button_link_1",
						"label": "Button link 1"
					},
          {
						"type": "select",
						"id": "button_color_1",
						"label": "Button color 1",
						"options": [
							{
								"value": "regular",
								"label": "Regular"
							},
							{
								"value": "accent",
								"label": "Accent"
							},
							{
								"value": "white",
								"label": "White"
							}
						],
						"default": "accent"
					},
          {
						"type": "text",
						"id": "button_text_2",
						"label": "Button label 2",
						"info": "Leave the label blank to hide the button."
					},
					{
						"type": "url",
						"id": "button_link_2",
						"label": "Button link 2"
					},
          {
						"type": "select",
						"id": "button_color_2",
						"label": "Button color 2",
						"options": [
							{
								"value": "regular",
								"label": "Regular"
							},
							{
								"value": "accent",
								"label": "Accent"
							},
							{
								"value": "white",
								"label": "White"
							}
						],
						"default": "accent"
					},
          {
						"type": "text",
						"id": "button_text_3",
						"label": "Button label 3",
						"info": "Leave the label blank to hide the button."
					},
					{
						"type": "url",
						"id": "button_link_3",
						"label": "Button link 3"
					},
          {
						"type": "select",
						"id": "button_color_3",
						"label": "Button color 3",
						"options": [
							{
								"value": "regular",
								"label": "Regular"
							},
							{
								"value": "accent",
								"label": "Accent"
							},
							{
								"value": "white",
								"label": "White"
							}
						],
						"default": "accent"
					},
          {
            "type": "header",
            "content": "Layout"
          },
          {
            "type": "select",
            "id": "layout",
            "options": [
              {
                "value": "image_first",
                "label": "Image first"
              },
              {
                "value": "text_first",
                "label": "Image second"
              }
            ],
            "default": "image_first",
            "label": "Desktop image placement",
            "info": "Image first is the default mobile layout."
          },
          {
            "type": "header",
            "content": "Colors"
          },
          {
            "type": "color",
            "id": "color_bg",
            "label": "Background",
            "default": "#ffffff"
          },
          {
            "type": "color",
            "id": "color_heading",
            "label": "Heading",
            "default": "#1a1c1d"
          },
          {
            "type": "color",
            "id": "color_text",
            "label": "Text",
            "default": "#2c2d2e"
          },
          {
            "type": "color",
            "id": "color_links",
            "label": "Links",
            "default": "#2c2d2e"
          },
          {
						"type": "color",
						"id": "marker_color",
						"label": "Marker",
						"default": "#FD6262"
					}
        ]
      }
    ],
    "presets": [
      {
        "name": "Multi image with text"
      }
    ],
		"enabled_on": {
			"templates": ["*"],
			"groups": [
				"header", "footer"
			]
		}
  }
{% endschema %}